CREATE OR REPLACE VIEW dv2_student_profile_ug FOLDER = '/3.derived views/@master data' DESCRIPTION = 'Student master captures all student profile related information, including demographics'  (
    hall_addr (description = 'Residential hall address'),
    entry_qualif_desc (description = 'Student''s entry qualification description'),
    residency_status (description = 'Residency status. SC: Singapore Citizen, PR: Permenant Resident, IS: International Student'),
    double_major_flag (description = '?? double major flag, ''Y'' when s_area_special2 is not null ??')
)
 AS SELECT dv2_student_records_ug.matric_nmbr AS matric_nmbr, dv2_student_records_ug.name AS name, dv2_student_records_ug.programme_code AS programme_code, ref_prog_school_college.programme_desc AS programme_desc, dv2_student_records_ug.area_special AS area_special, dv2_student_records_ug.area_special2 AS area_special2, case WHEN (dv2_student_records_ug.area_special2 is not null ) THEN 'Y' WHEN (dv2_student_records_ug.area_special2 is not null ) THEN 'N' END AS double_major_flag, ref_cdb_course.cdbcourse_double_degree AS double_degree_flag, ref_prog_school_college.school AS school, ref_prog_school_college.college AS college, ref_prog_school_college.cluster AS cluster, dv2_student_records_ug.student_category AS student_category, dv2_student_records_ug.student_type AS student_type, dv2_student_records_ug.adm_yr_offer AS adm_yr_offer, dv2_student_records_ug.adm_yr_actual AS adm_yr_actual, dv2_student_records_ug.admission_semester AS admission_semester, dv2_student_records_ug.study_yr AS study_yr, dv2_student_records_ug.student_status AS student_status, ref_student_status.cdbstudent_status_desc AS student_status_desc, dv2_student_records_ug.drop_dt_left AS drop_dt_left, dv2_student_records_ug.drop_reason AS drop_reason, dv2_student_records_ug.gr_graduated_yr AS graduated_yr, dv2_student_records_ug.gender AS gender, dv2_student_records_ug.nationality AS nationality, dv2_student_records_ug.pr_status AS pr_status, case WHEN (dv2_student_records_ug.pr_status = 'SG') THEN 'SPR' WHEN (dv2_student_records_ug.nationality = 'SG') THEN 'SC' ELSE 'IS' END AS residency_status, dv2_student_records_ug.orig_nationality AS orig_nationality, dv2_student_records_ug.birth_dt AS birth_dt, dv2_student_records_ug.birth_place AS birth_place, dv2_student_records_ug.nric_nmbr AS nric_nmbr, dv2_student_records_ug.fid_nmbr AS fid_nmbr, dv2_student_records_ug.marital_status AS marital_status, dv2_student_records_ug.race AS race, dv2_student_records_ug.religion AS religion, dv2_student_records_ug.ns_status AS ns_status, dv2_student_records_ug.home_addr AS home_addr, dv2_student_records_ug.home_pcode AS home_pcode, dv2_student_records_ug.home_tel AS home_tel, dv2_student_records_ug.term_addrty AS term_addrty, dv2_student_records_ug.term_addr AS term_addr, dv2_student_records_ug.term_pcode AS term_pcode, dv2_student_records_ug.term_tel AS term_tel, dv2_student_records_ug.hall_addr AS hall_addr, dv2_student_records_ug.handphone_nmbr AS handphone_nmbr, dv2_student_records_ug.personal_email AS personal_email, dv2_student_records_ug.guard_name AS guard_name, dv2_student_records_ug.guard_addr AS guard_addr, dv2_student_records_ug.guard_tel AS guard_tel, dv2_student_records_ug.s_guard_email AS guard_email, dv2_student_records_ug.guard_relatn AS guard_relatn, dv2_student_records_ug.guard_occupatn AS guard_occupatn, dv2_student_records_ug.application_nmbr AS application_nmbr, dv2_student_records_ug.direct_entry AS direct_entry, dv2_student_records_ug.entry_qualif AS entry_qualif, ref_entry_qualification.cdbentr_desc AS entry_qualif_desc, dv2_student_records_ug.moe_school_type AS moe_school_type, dv2_student_records_ug.jc_school AS jc_school_code, ref_jc_school_name.cdbschl_name AS jc_schlool_name, dv2_student_records_ug.qet_attendance AS qet_attendance, dv2_student_records_ug.english_profcy AS english_profcy, dv2_student_records_ug.cn_yang_scholars AS cn_yang_scholars, dv2_student_records_ug.usp_scholars AS usp_scholars, dv2_student_records_ug.disability_flag AS disability_flag, dv2_student_records_ug.disability_detail AS disability_detail, dv2_student_records_ug.schlrship_ty AS schlrship_ty, dv2_student_records_ug.s_grant AS s_grant, dv2_student_records_ug.fee_catg AS fee_catg, dv2_student_records_ug.fee_paid AS fee_paid, dv2_student_records_ug.acct_nmbr AS acct_nmbr, dv2_student_records_ug.previous_programme AS previous_programme, dv2_student_records_ug.provisional_offer AS provisional_offer, dv2_student_records_ug.moe_schlr_adm_status AS moe_schlr_adm_status, dv2_student_records_ug.accelerated_bachelor AS accelerated_bachelor, dv2_student_records_ug.s_subsidy AS subsidy, dv2_student_records_ug.s_subsidy_percent AS subsidy_percent, dv2_student_records_ug.nmbr_sem_tg_taken AS nmbr_sem_tg_taken, dv2_student_records_ug.moe_tg_not_elig_from AS moe_tg_not_elig_from, dv2_student_records_ug.moe_tg_ntusub_not_elig_from AS moe_tg_ntusub_not_elig_from, dv2_student_records_ug.family_income AS family_income, dv2_student_records_ug.family_pci AS family_pci, dv2_student_records_ug.nmbr_family AS nmbr_family, ref_residence_type.cdbresidencetype_desc AS residence_type_desc, ref_residence_ownership.cdbresidenceownership_desc AS residence_ownership_desc FROM ((((((dv2_student_records_ug AS dv2_student_records_ug LEFT OUTER JOIN ref_prog_school_college_ug AS ref_prog_school_college ON dv2_student_records_ug.programme_code = ref_prog_school_college.programme_code ) LEFT OUTER JOIN ref_entry_qualification AS ref_entry_qualification ON dv2_student_records_ug.entry_qualif = ref_entry_qualification.cdbentr_code ) LEFT OUTER JOIN ref_jc_school_name AS ref_jc_school_name ON dv2_student_records_ug.jc_school = ref_jc_school_name.cdbschl_code ) LEFT OUTER JOIN ref_student_status AS ref_student_status ON dv2_student_records_ug.student_status = ref_student_status.cdbstudent_status_code ) LEFT OUTER JOIN ref_residence_type AS ref_residence_type ON dv2_student_records_ug.residence_type = ref_residence_type.cdbresidencetype_code ) LEFT OUTER JOIN ref_residence_ownership AS ref_residence_ownership ON dv2_student_records_ug.residence_ownership = ref_residence_ownership.cdbresidenceownership_code ) LEFT OUTER JOIN ref_cdb_course AS ref_cdb_course ON ref_prog_school_college.programme_code = ref_cdb_course.cdbcourse_code  WHERE ref_cdb_course.cdbcourse_type = 'UND';

ALTER VIEW dv2_student_profile_ug
 LAYOUT (dv2_student_records_ug = [70, 10, 350, 780], ref_prog_school_college_ug = [470, 30, 200, 166], ref_entry_qualification = [480, 230, 200, 106], ref_jc_school_name = [480, 630, 200, 225], ref_student_status = [480, 360, 200, 66], ref_residence_type = [480, 450, 200, 66], ref_residence_ownership = [480, 550, 200, 66], ref_cdb_course = [730, 30, 200, 146]);

