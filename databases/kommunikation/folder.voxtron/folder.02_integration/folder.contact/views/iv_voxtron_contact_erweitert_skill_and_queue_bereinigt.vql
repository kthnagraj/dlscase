CREATE OR REPLACE VIEW iv_voxtron_contact_erweitert_skill_and_queue_bereinigt FOLDER = '/voxtron/02_integration/contact'
    PRIMARY KEY ( 'contact_contactid' , 'skillid' , 'contactqueue_queueid' ) (
    skill_name_bereinigt (description = 'Skill Namen, wobei die FD Skills mit ihren Nebenstellen zu jeweils einem einzigen FD Skill zusammengefasst sind')
)
 AS SELECT iv_voxtron_contact_erweitert_skill_and_queue.contact_contactid AS contact_contactid, iv_voxtron_contact_erweitert_skill_and_queue.contact_conferenceid AS contact_conferenceid, iv_voxtron_contact_erweitert_skill_and_queue.contact_contacttypeid AS contact_contacttypeid, iv_voxtron_contact_erweitert_skill_and_queue.contact_from_0 AS contact_from_0, iv_voxtron_contact_erweitert_skill_and_queue.contact_from_origin AS contact_from_origin, iv_voxtron_contact_erweitert_skill_and_queue.contact_to_0 AS contact_to_0, iv_voxtron_contact_erweitert_skill_and_queue.contact_timecreated AS contact_timecreated, iv_voxtron_contact_erweitert_skill_and_queue.contact_waitingtimelength AS contact_waitingtimelength, iv_voxtron_contact_erweitert_skill_and_queue.contact_conversationlength AS contact_conversationlength, iv_voxtron_contact_erweitert_skill_and_queue.contact_handledby AS contact_handledby, iv_voxtron_contact_erweitert_skill_and_queue.contact_sentby AS contact_sentby, iv_voxtron_contact_erweitert_skill_and_queue.contact_senderid AS contact_senderid, iv_voxtron_contact_erweitert_skill_and_queue.contact_receiverid AS contact_receiverid, iv_voxtron_contact_erweitert_skill_and_queue.contact_companyname AS contact_companyname, iv_voxtron_contact_erweitert_skill_and_queue.contact_recipientname AS contact_recipientname, iv_voxtron_contact_erweitert_skill_and_queue.contact_isshortcontact AS contact_isshortcontact, iv_voxtron_contact_erweitert_skill_and_queue.contact_lastupdaterowversion AS contact_lastupdaterowversion, iv_voxtron_contact_erweitert_skill_and_queue.contact_callsetupdatetime AS contact_callsetupdatetime, iv_voxtron_contact_erweitert_skill_and_queue.contact_resultcode AS contact_resultcode, iv_voxtron_contact_erweitert_skill_and_queue.contact_lastassignedagent AS contact_lastassignedagent, iv_voxtron_contact_erweitert_skill_and_queue.contact_lastassignedqueue AS contact_lastassignedqueue, iv_voxtron_contact_erweitert_skill_and_queue.contact_hascontent AS contact_hascontent, iv_voxtron_contact_erweitert_skill_and_queue.contact_customerid AS contact_customerid, iv_voxtron_contact_erweitert_skill_and_queue.contact_subtype AS contact_subtype, iv_voxtron_contact_erweitert_skill_and_queue.contact_contactdate AS contact_contactdate, iv_voxtron_contact_erweitert_skill_and_queue.contact_contacttime AS contact_contacttime, iv_voxtron_contact_erweitert_skill_and_queue.contact_year AS contact_year, iv_voxtron_contact_erweitert_skill_and_queue.contact_month AS contact_month, iv_voxtron_contact_erweitert_skill_and_queue.contact_day AS contact_day, iv_voxtron_contact_erweitert_skill_and_queue.contact_hour AS contact_hour, iv_voxtron_contact_erweitert_skill_and_queue.contact_dayofweek AS contact_dayofweek, iv_voxtron_contact_erweitert_skill_and_queue.contact_wrapuplength AS contact_wrapuplength, iv_voxtron_contact_erweitert_skill_and_queue.contactactionlog_ringingtimelength AS contactactionlog_ringingtimelength, iv_voxtron_contact_erweitert_skill_and_queue.contacttype_description AS contacttype_description, iv_voxtron_contact_erweitert_skill_and_queue.contacttype_lastupdaterowversion AS contacttype_lastupdaterowversion, iv_voxtron_contact_erweitert_skill_and_queue.isinueberlauf AS isinueberlauf, iv_voxtron_contact_erweitert_skill_and_queue._param_contactdate_start AS _param_contactdate_start, iv_voxtron_contact_erweitert_skill_and_queue._param_contactdate_end AS _param_contactdate_end, iv_voxtron_contact_erweitert_skill_and_queue.skillid AS skillid, iv_voxtron_contact_erweitert_skill_and_queue.skill_name AS skill_name, case WHEN ((skill_name = '551' OR skill_is_fdmnebenstelle)) THEN 'FD-M' ELSE case WHEN ((skill_name like 'FDB%' OR skill_name = '1728')) THEN 'FD-B' ELSE case WHEN ((skill_name like 'FDD%' OR skill_name = '1748')) THEN 'FD-D' ELSE case WHEN ((skill_name like 'FDF%' OR skill_name = '1768')) THEN 'FD-F' ELSE case WHEN ((skill_name like 'FDS%' OR skill_name = '1888')) THEN 'FD-S' ELSE case WHEN ((skill_name like 'FDHH%' OR skill_name = '1788')) THEN 'FD-HH' ELSE skill_name END END END END END END AS skill_name_bereinigt, iv_voxtron_contact_erweitert_skill_and_queue.skill_is_fdmnebenstelle AS skill_is_fdmnebenstelle, iv_voxtron_contact_erweitert_skill_and_queue.skill_importance AS skill_importance, iv_voxtron_contact_erweitert_skill_and_queue.skill_isactive AS skill_isactive, iv_voxtron_contact_erweitert_skill_and_queue.skill_ismandatory AS skill_ismandatory, iv_voxtron_contact_erweitert_skill_and_queue.contactqueue_queueid AS contactqueue_queueid, iv_voxtron_contact_erweitert_skill_and_queue.contactqueue_assignedcount AS contactqueue_assignedcount, iv_voxtron_contact_erweitert_skill_and_queue.contactqueue_handledcount AS contactqueue_handledcount, iv_voxtron_contact_erweitert_skill_and_queue.queue_name AS queue_name, iv_voxtron_contact_erweitert_skill_and_queue.queue_isdefault AS queue_isdefault, iv_voxtron_contact_erweitert_skill_and_queue.queue_isactive AS queue_isactive, iv_voxtron_contact_erweitert_skill_and_queue.queue_defaultagentsettings AS queue_defaultagentsettings, iv_voxtron_contact_erweitert_skill_and_queue.queue_defaultrouting AS queue_defaultrouting, iv_voxtron_contact_erweitert_skill_and_queue.queue_defaultadvancedrouting AS queue_defaultadvancedrouting, iv_voxtron_contact_erweitert_skill_and_queue.queue_defaulttimes AS queue_defaulttimes, iv_voxtron_contact_erweitert_skill_and_queue.queue_appuserid AS queue_appuserid, iv_voxtron_contact_erweitert_skill_and_queue.queue_lastupdaterowversion AS queue_lastupdaterowversion, iv_voxtron_contact_erweitert_skill_and_queue.queue_contactcodesmandatory AS queue_contactcodesmandatory, iv_voxtron_contact_erweitert_skill_and_queue.queue_contactcodesmandatoryonfailure AS queue_contactcodesmandatoryonfailure FROM iv_voxtron_contact_erweitert_skill_and_queue;

ALTER VIEW iv_voxtron_contact_erweitert_skill_and_queue_bereinigt
 LAYOUT (iv_voxtron_contact_erweitert_skill_and_queue = [20, 20, 354, 780]);

